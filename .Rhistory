attribtionSentencesPathogen('Norovirus')
attribtionSentencesPathogen <- function(pathogen){
cl <- CostList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages')
InitDisease <- PathogenAssumptions[[pathogen]]$name
SequelDiseases <- names(PathogenAssumptions[[pathogen]]$sequelae)
TotalCost <- subset(cl, Source == 'AllFood' &
Disease == 'Initial and sequel disease')$median #not tidied until later as it is needed for calculation fractions
CasesInit <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
CasesSequel <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
Hosp <- subset(el, Source == 'AllFood' &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
Deaths <- subset(el, Source == 'AllFood' &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' & Source != 'AllFood') %>% arrange(desc(median))
SourcesOrdered <- SourceCosts$Source
SourceCostsOrdered <- SourceCosts$median
SourcePropOrdered <- round(SourceCostsOrdered/TotalCost* 100)
SourceCostsOrdered <- SourceCostsOrdered %>% tidyNumber(unit = 10^6, round = FALSE)
TotalCost <- TotalCost %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCases <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
LeadingSourceCasesSequel <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
LeadingSourceHosp <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
LeadingSourceDeaths <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
hasSequel <- length(SequelDiseases) > 0
str_glue(
'{pathogen} resulted in an annual cost of approximately {TotalCost} million
AUD circa 2019 arising from {CasesInit} episodes of initial illness, ',
if(hasSequel){'{CasesSequel} episodes of sequel illness ({textlist(tolower(SequelDiseases),conj = "or")}), '}else{''},
'{Hosp} hospitalisations, and {textCountObj(Deaths, "death")}. {SourcesOrdered[1]}
{matchVerbNoun("was",SourcesOrdered[1])} the leading source ({SourcePropOrdered[1]}%)
with a total annual cost of {SourceCostsOrdered[1]} million AUD arising from
{LeadingSourceCases} episodes of', if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{LeadingSourceCasesSequel} episodes of sequel illness, '}else{''},
'{LeadingSourceHosp} hospitalisations, and {LeadingSourceDeaths} deaths. The
next three most frequent sources were {tolower(SourcesOrdered[2])}
({SourcePropOrdered[2]}%), {tolower(SourcesOrdered[3])} ({SourcePropOrdered[3]}%),
and {tolower(SourcesOrdered[4])} ({SourcePropOrdered[4]}%).'
) %>%
gsub('\n',' ',., fixed = TRUE)
}
attribtionSentencesPathogen('Norovirus')
attribtionSentencesPathogen <- function(pathogen){
cl <- CostList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages')
InitDisease <- PathogenAssumptions[[pathogen]]$name
SequelDiseases <- names(PathogenAssumptions[[pathogen]]$sequelae)
TotalCost <- subset(cl, Source == 'AllFood' &
Disease == 'Initial and sequel disease')$median #not tidied until later as it is needed for calculation fractions
CasesInit <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
CasesSequel <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
Hosp <- subset(el, Source == 'AllFood' &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
Deaths <- subset(el, Source == 'AllFood' &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' & Source != 'AllFood') %>% arrange(desc(median))
SourcesOrdered <- SourceCosts$Source
SourceCostsOrdered <- SourceCosts$median
SourcePropOrdered <- round(SourceCostsOrdered/TotalCost* 100)
SourceCostsOrdered <- SourceCostsOrdered %>% tidyNumber(unit = 10^6, round = FALSE)
TotalCost <- TotalCost %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCases <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
LeadingSourceCasesSequel <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
LeadingSourceHosp <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
LeadingSourceDeaths <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
print(SequelDiseases)
hasSequel <- length(SequelDiseases) > 0
str_glue(
'{pathogen} resulted in an annual cost of approximately {TotalCost} million
AUD circa 2019 arising from {CasesInit} episodes of initial illness, ',
if(hasSequel){'{CasesSequel} episodes of sequel illness ({textlist(tolower(SequelDiseases),conj = "or")}), '}else{''},
'{Hosp} hospitalisations, and {textCountObj(Deaths, "death")}. {SourcesOrdered[1]}
{matchVerbNoun("was",SourcesOrdered[1])} the leading source ({SourcePropOrdered[1]}%)
with a total annual cost of {SourceCostsOrdered[1]} million AUD arising from
{LeadingSourceCases} episodes of', if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{LeadingSourceCasesSequel} episodes of sequel illness, '}else{''},
'{LeadingSourceHosp} hospitalisations, and {LeadingSourceDeaths} deaths. The
next three most frequent sources were {tolower(SourcesOrdered[2])}
({SourcePropOrdered[2]}%), {tolower(SourcesOrdered[3])} ({SourcePropOrdered[3]}%),
and {tolower(SourcesOrdered[4])} ({SourcePropOrdered[4]}%).'
) %>%
gsub('\n',' ',., fixed = TRUE)
}
attribtionSentencesPathogen('Norovirus')
PathogenAssumptions
PathogenAssumptions[['Norovirus']]
PathogenAssumptions[['Norovirus']]$sequelae
names(PathogenAssumptions[['Norovirus']]$sequelae)
length(names(PathogenAssumptions[['Norovirus']]$sequelae))
length(names(PathogenAssumptions[['Norovirus']]$sequelae)) > 0
attribtionSentencesPathogen <- function(pathogen){
cl <- CostList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages')
InitDisease <- PathogenAssumptions[[pathogen]]$name
SequelDiseases <- names(PathogenAssumptions[[pathogen]]$sequelae)
TotalCost <- subset(cl, Source == 'AllFood' &
Disease == 'Initial and sequel disease')$median #not tidied until later as it is needed for calculation fractions
CasesInit <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
CasesSequel <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
Hosp <- subset(el, Source == 'AllFood' &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
Deaths <- subset(el, Source == 'AllFood' &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' & Source != 'AllFood') %>% arrange(desc(median))
SourcesOrdered <- SourceCosts$Source
SourceCostsOrdered <- SourceCosts$median
SourcePropOrdered <- round(SourceCostsOrdered/TotalCost* 100)
SourceCostsOrdered <- SourceCostsOrdered %>% tidyNumber(unit = 10^6, round = FALSE)
TotalCost <- TotalCost %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCases <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
LeadingSourceCasesSequel <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
LeadingSourceHosp <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
LeadingSourceDeaths <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
print(SequelDiseases)
hasSequel <- length(SequelDiseases) > 0
print(hasSequel)
str_glue(
'{pathogen} resulted in an annual cost of approximately {TotalCost} million
AUD circa 2019 arising from {CasesInit} episodes of initial illness, ',
if(hasSequel){'{CasesSequel} episodes of sequel illness ({textlist(tolower(SequelDiseases),conj = "or")}), '}else{''},
'{Hosp} hospitalisations, and {textCountObj(Deaths, "death")}. {SourcesOrdered[1]}
{matchVerbNoun("was",SourcesOrdered[1])} the leading source ({SourcePropOrdered[1]}%)
with a total annual cost of {SourceCostsOrdered[1]} million AUD arising from
{LeadingSourceCases} episodes of', if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{LeadingSourceCasesSequel} episodes of sequel illness, '}else{''},
'{LeadingSourceHosp} hospitalisations, and {LeadingSourceDeaths} deaths. The
next three most frequent sources were {tolower(SourcesOrdered[2])}
({SourcePropOrdered[2]}%), {tolower(SourcesOrdered[3])} ({SourcePropOrdered[3]}%),
and {tolower(SourcesOrdered[4])} ({SourcePropOrdered[4]}%).'
) %>%
gsub('\n',' ',., fixed = TRUE)
}
attribtionSentencesPathogen('Norovirus')
attribtionSentencesPathogen <- function(pathogen){
cl <- CostList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages')
InitDisease <- PathogenAssumptions[[pathogen]]$name
SequelDiseases <- names(PathogenAssumptions[[pathogen]]$sequelae)
TotalCost <- subset(cl, Source == 'AllFood' &
Disease == 'Initial and sequel disease')$median #not tidied until later as it is needed for calculation fractions
CasesInit <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
CasesSequel <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
Hosp <- subset(el, Source == 'AllFood' &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
Deaths <- subset(el, Source == 'AllFood' &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' & Source != 'AllFood') %>% arrange(desc(median))
SourcesOrdered <- SourceCosts$Source
SourceCostsOrdered <- SourceCosts$median
SourcePropOrdered <- round(SourceCostsOrdered/TotalCost* 100)
SourceCostsOrdered <- SourceCostsOrdered %>% tidyNumber(unit = 10^6, round = FALSE)
TotalCost <- TotalCost %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCases <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
LeadingSourceCasesSequel <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
LeadingSourceHosp <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
LeadingSourceDeaths <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
print(SequelDiseases)
hasSequel <- length(SequelDiseases) > 0
print(hasSequel)
str_glue(
'{pathogen} resulted in an annual cost of approximately {TotalCost} million
AUD circa 2019 arising from {CasesInit} episodes of',
if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{CasesSequel} episodes of sequel illness ({textlist(tolower(SequelDiseases),conj = "or")}), '}else{''},
'{Hosp} hospitalisations, and {textCountObj(Deaths, "death")}. {SourcesOrdered[1]}
{matchVerbNoun("was",SourcesOrdered[1])} the leading source ({SourcePropOrdered[1]}%)
with a total annual cost of {SourceCostsOrdered[1]} million AUD arising from
{LeadingSourceCases} episodes of', if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{LeadingSourceCasesSequel} episodes of sequel illness, '}else{''},
'{LeadingSourceHosp} hospitalisations, and {LeadingSourceDeaths} deaths. The
next three most frequent sources were {tolower(SourcesOrdered[2])}
({SourcePropOrdered[2]}%), {tolower(SourcesOrdered[3])} ({SourcePropOrdered[3]}%),
and {tolower(SourcesOrdered[4])} ({SourcePropOrdered[4]}%).'
) %>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource <- function(){
cl <- CostList %>% subset(Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Measure == 'Cases' &
Agegroup == 'All ages'&
Disease == 'Initial')
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' &
Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCostOrdered <- SourceCosts$Source
SourcesCostOrderedCosts <- SourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCosts <- subset(cl, Disease == 'Initial and sequel disease' &
Pathogen != 'All pathogens' &
Source == SourcesCostOrdered[1]) %>% arrange(desc(median))
PathogensCostOrdered <- LeadingSourceCosts$Pathogen
PathogensCostOrderedCosts <- LeadingSourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
## Sources by number of
SourceCases <-  subset(el, Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCaseOrdered <- SourceCases$Source
SourcesCaseOrderedCases <- SourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
LeadingSourceCases <- subset(el, Pathogen != 'All pathogens' &
Source == SourcesCaseOrdered[1]) %>% arrange(desc(median))
PathogensCaseOrdered <- LeadingSourceCases$Pathogen
PathogensCaseOrderedCases <- LeadingSourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
str_glue(
'Among the pathogens and food categories considered, {tolower(SourcesCostOrdered[1])} was
associated with the greatest cost of foodborne illness, with a total cost of
{SourcesCostOrderedCosts[1]} million AUD. Of this total ',
textlist(glue('{PathogensCostOrderedCosts} million AUD was due to {PathogensCostOrdered}')),
'. The food category associated with the most cases of foodborne illness circa 2019
illness was', if(SourcesCaseOrdered[1] == SourcesCostOrdered[1]){' also '}else{' '},
'{tolower(SourcesCaseOrdered[1])}, with total burden of {SourcesCaseOrderedCases[1]} cases. Of this total, ',
textlist(glue('{PathogensCaseOrderedCases} cases were due to {PathogensCaseOrdered}')),'.'
)%>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource() %>% write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n')
attribtionSentencesPathogen('Norovirus')
attribtionSentencesPathogen('STEC')
attributionSentencesSource <- function(){
cl <- CostList %>% subset(Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Measure == 'Cases' &
Agegroup == 'All ages'&
Disease == 'Initial')
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' &
Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCostOrdered <- SourceCosts$Source
SourcesCostOrderedCosts <- SourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCosts <- subset(cl, Disease == 'Initial and sequel disease' &
Pathogen != 'All pathogens' &
Source == SourcesCostOrdered[1]) %>% arrange(desc(median))
PathogensCostOrdered <- LeadingSourceCosts$Pathogen
PathogensCostOrderedCosts <- LeadingSourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
## Sources by number of
SourceCases <-  subset(el, Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCaseOrdered <- SourceCases$Source
SourcesCaseOrderedCases <- SourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
LeadingSourceCases <- subset(el, Pathogen != 'All pathogens' &
Source == SourcesCaseOrdered[1]) %>% arrange(desc(median))
PathogensCaseOrdered <- LeadingSourceCases$Pathogen
PathogensCaseOrderedCases <- LeadingSourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
str_glue(
'Among the pathogens and food categories considered, {tolower(SourcesCostOrdered[1])} was
associated with the greatest cost of foodborne illness, with a total cost of
{SourcesCostOrderedCosts[1]} million AUD. Of this total ',
textlist(glue('{PathogensCostOrderedCosts} million AUD was due to {PathogensCostOrdered}')),
'. The food category associated with the most cases of foodborne illness circa 2019
illness was', if(SourcesCaseOrdered[1] == SourcesCostOrdered[1]){' also '}else{' '},
'{tolower(SourcesCaseOrdered[1])}, with total burden of {SourcesCaseOrderedCases[1]} cases. Of this total, ',
textlist(glue('{PathogensCaseOrderedCases} cases were due to {PathogensCaseOrdered}')),'.'
)%>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource() %>% write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n')
attribtionSentencesPathogen('STEC')
attribtionSentencesPathogen <- function(pathogen){
cl <- CostList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Pathogen == pathogen &
Agegroup == 'All ages')
InitDisease <- PathogenAssumptions[[pathogen]]$name
SequelDiseases <- names(PathogenAssumptions[[pathogen]]$sequelae)
TotalCost <- subset(cl, Source == 'AllFood' &
Disease == 'Initial and sequel disease')$median #not tidied until later as it is needed for calculation fractions
CasesInit <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
CasesSequel <- subset(el, Source == 'AllFood' &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
Hosp <- subset(el, Source == 'AllFood' &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
Deaths <- subset(el, Source == 'AllFood' &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' & Source != 'AllFood') %>% arrange(desc(median))
SourcesOrdered <- SourceCosts$Source
SourceCostsOrdered <- SourceCosts$median
SourcePropOrdered <- round(SourceCostsOrdered/TotalCost* 100)
SourceCostsOrdered <- SourceCostsOrdered %>% tidyNumber(unit = 10^6, round = FALSE)
TotalCost <- TotalCost %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCases <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease == 'Initial')$median %>% tidyNumber(unit = 1)
LeadingSourceCasesSequel <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Cases' &
Disease %in% SequelDiseases)$median %>% sum %>% tidyNumber(unit = 1)
LeadingSourceHosp <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Hospitalisations' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
LeadingSourceDeaths <- subset(el, Source == SourcesOrdered[1] &
Measure == 'Deaths' &
Disease == 'Initial and sequel disease')$median %>% tidyNumber(unit = 1)
hasSequel <- length(SequelDiseases) > 0
str_glue(
'{pathogen} resulted in an annual cost of approximately {TotalCost} million
AUD circa 2019 arising from {CasesInit} cases of',
if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{CasesSequel} cases of sequel illness ({textlist(tolower(SequelDiseases),conj = "or")}), '}else{''},
'{Hosp} hospitalisations, and {textCountObj(Deaths, "death")}. {SourcesOrdered[1]}
{matchVerbNoun("was",SourcesOrdered[1])} the leading source ({SourcePropOrdered[1]}%)
with a total annual cost of {SourceCostsOrdered[1]} million AUD arising from
{LeadingSourceCases} cases of', if(hasSequel){' initial '}else{' '},'illness, ',
if(hasSequel){'{LeadingSourceCasesSequel} cases of sequel illness, '}else{''},
'{LeadingSourceHosp} hospitalisations, and {LeadingSourceDeaths} deaths. The
next three most frequent sources were {tolower(SourcesOrdered[2])}
({SourcePropOrdered[2]}%), {tolower(SourcesOrdered[3])} ({SourcePropOrdered[3]}%),
and {tolower(SourcesOrdered[4])} ({SourcePropOrdered[4]}%).'
) %>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource <- function(){
cl <- CostList %>% subset(Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Measure == 'Cases' &
Agegroup == 'All ages'&
Disease == 'Initial')
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' &
Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCostOrdered <- SourceCosts$Source
SourcesCostOrderedCosts <- SourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCosts <- subset(cl, Disease == 'Initial and sequel disease' &
Pathogen != 'All pathogens' &
Source == SourcesCostOrdered[1]) %>% arrange(desc(median))
PathogensCostOrdered <- LeadingSourceCosts$Pathogen
PathogensCostOrderedCosts <- LeadingSourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
## Sources by number of
SourceCases <-  subset(el, Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCaseOrdered <- SourceCases$Source
SourcesCaseOrderedCases <- SourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
LeadingSourceCases <- subset(el, Pathogen != 'All pathogens' &
Source == SourcesCaseOrdered[1]) %>% arrange(desc(median))
PathogensCaseOrdered <- LeadingSourceCases$Pathogen
PathogensCaseOrderedCases <- LeadingSourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
str_glue(
'Among the pathogens and food categories considered, {tolower(SourcesCostOrdered[1])} was
associated with the greatest cost of foodborne illness, with a total cost of
{SourcesCostOrderedCosts[1]} million AUD. Of this total ',
textlist(glue('{PathogensCostOrderedCosts} million AUD was due to {PathogensCostOrdered}')),
'. The food category associated with the most cases of foodborne illness circa 2019
illness was', if(SourcesCaseOrdered[1] == SourcesCostOrdered[1]){' also '}else{' '},
'{tolower(SourcesCaseOrdered[1])}, with total burden of {SourcesCaseOrderedCases[1]} cases. Of this total, ',
textlist(glue('{PathogensCaseOrderedCases} cases were due to {PathogensCaseOrdered}')),'.'
)%>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource() %>% write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n')
CommonPathogens %>%
map(attribtionSentencesPathogen) %>%
write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n', append = TRUE)
attributionSentencesSource <- function(){
cl <- CostList %>% subset(Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Measure == 'Cases' &
Agegroup == 'All ages'&
Disease == 'Initial')
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' &
Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCostOrdered <- SourceCosts$Source
SourcesCostOrderedCosts <- SourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCosts <- subset(cl, Disease == 'Initial and sequel disease' &
Pathogen != 'All pathogens' &
Source == SourcesCostOrdered[1]) %>% arrange(desc(median))
PathogensCostOrdered <- LeadingSourceCosts$Pathogen
PathogensCostOrderedCosts <- LeadingSourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
## Sources by number of
SourceCases <-  subset(el, Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCaseOrdered <- SourceCases$Source
SourcesCaseOrderedCases <- SourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
LeadingSourceCases <- subset(el, Pathogen != 'All pathogens' &
Source == SourcesCaseOrdered[1]) %>% arrange(desc(median))
PathogensCaseOrdered <- LeadingSourceCases$Pathogen
PathogensCaseOrderedCases <- LeadingSourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
str_glue(
'Among the pathogens and food categories considered, {tolower(SourcesCostOrdered[1])} was
associated with the greatest cost of foodborne illness, with a total cost of
{SourcesCostOrderedCosts[1]} million AUD. Of this total ',
textlist(glue('{PathogensCostOrderedCosts} million AUD was due to {PathogensCostOrdered}')),
'. The food category associated with the most cases of foodborne illness circa 2019
illness was', if(SourcesCaseOrdered[1] == SourcesCostOrdered[1]){' also '}else{' '},
'{tolower(SourcesCaseOrdered[1])}, with a total burden of {SourcesCaseOrderedCases[1]} cases. Of this total, ',
textlist(glue('{PathogensCaseOrderedCases} cases were due to {PathogensCaseOrdered}')),'.'
)%>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource() %>% write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n')
CommonPathogens %>%
map(attribtionSentencesPathogen) %>%
write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n', append = TRUE)
attributionSentencesSource <- function(){
cl <- CostList %>% subset(Agegroup == 'All ages' &
CostCategory == "TotalHumanCapital")
el <- EpiList %>% subset(Measure == 'Cases' &
Agegroup == 'All ages'&
Disease == 'Initial')
SourceCosts <-  subset(cl, Disease == 'Initial and sequel disease' &
Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCostOrdered <- SourceCosts$Source
SourcesCostOrderedCosts <- SourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
LeadingSourceCosts <- subset(cl, Disease == 'Initial and sequel disease' &
Pathogen != 'All pathogens' &
Source == SourcesCostOrdered[1]) %>% arrange(desc(median))
PathogensCostOrdered <- LeadingSourceCosts$Pathogen
PathogensCostOrderedCosts <- LeadingSourceCosts$median %>% tidyNumber(unit = 10^6, round = FALSE)
## Sources by number of
SourceCases <-  subset(el, Pathogen == 'All pathogens' &
Source != 'AllFood') %>% arrange(desc(median))
SourcesCaseOrdered <- SourceCases$Source
SourcesCaseOrderedCases <- SourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
LeadingSourceCases <- subset(el, Pathogen != 'All pathogens' &
Source == SourcesCaseOrdered[1]) %>% arrange(desc(median))
PathogensCaseOrdered <- LeadingSourceCases$Pathogen
PathogensCaseOrderedCases <- LeadingSourceCases$median %>% tidyNumber(unit = 1, round = TRUE)
str_glue(
'Among the pathogens and food categories considered, {tolower(SourcesCostOrdered[1])} was
associated with the greatest cost of foodborne illness, with a total cost of
{SourcesCostOrderedCosts[1]} million AUD. Of this total ',
textlist(glue('{PathogensCostOrderedCosts} million AUD was due to {PathogensCostOrdered}')),
'. The food category associated with the most cases of foodborne illness circa 2019
was', if(SourcesCaseOrdered[1] == SourcesCostOrdered[1]){' also '}else{' '},
'{tolower(SourcesCaseOrdered[1])}, with a total burden of {SourcesCaseOrderedCases[1]} cases. Of this total, ',
textlist(glue('{PathogensCaseOrderedCases} cases were due to {PathogensCaseOrdered}')),'.'
)%>%
gsub('\n',' ',., fixed = TRUE)
}
attributionSentencesSource() %>% write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n')
CommonPathogens %>%
map(attribtionSentencesPathogen) %>%
write_lines('AttributionReport/PathogenAttributionSummariesText.txt',
sep = '\n\n', append = TRUE)
