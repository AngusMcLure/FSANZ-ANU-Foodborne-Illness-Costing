group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost))
CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)),
by ='Pathogen')
CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen')
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
geom_text(hjust = -0.2) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
theme(legend.position = c(0.75, 0.15)) +
theme(text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black')
CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip()
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
ggsave(P.CostPerPaseTotals,
filename = 'Paper and Presentations/CostPerCase.png',
height = 12/2.54, width = 7/2.54)
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 20)
P.CostPerPaseTotals
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(data = CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))),
hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
CostPerCase
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(data = CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))),
mapping = aes(y = median/1000)
hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000, alpha = SequelOrInitial,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(data = CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))),
mapping = aes(y = median/1000),
hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(aes(alpha = SequelOrInitial),
stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(data = CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))),
mapping = aes(y = median/1000),
hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
ggsave(P.CostPerPaseTotals,
filename = 'Paper and Presentations/CostPerCase.png',
height = 12/2.54, width = 7/2.54)
P.CostPerPaseTotals  <- CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
merge(CostTotals %>%
group_by(Pathogen, SequelOrInitial) %>%
summarise(Cost = sum(`Annual cost (millions AUD)`)) %>%
mutate(CostFraction = Cost/sum(Cost)) %>% select(-Cost),
by ='Pathogen') %>%
ggplot(aes(x = factor(Pathogen, levels = PathogenByCost),
y = median * CostFraction/1000,
label = sprintf("%0.1f", round(median/1000,1)))) +
geom_bar(#aes(alpha = SequelOrInitial),
fill = 'orange',
stat = 'identity', position = 'stack', color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
ylab('Cost per case\n(thousands AUD)') +
xlab('Pathogen') +
coord_flip() +
geom_text(data = CostPerCase %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))),
mapping = aes(y = median/1000),
hjust = -0.2) +
theme(legend.position = 'none',
text = element_text(size = 12),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()) +
ylim(0, 1000)
P.CostPerPaseTotals
ggsave(P.CostPerPaseTotals,
filename = 'Paper and Presentations/CostPerCase.png',
height = 12/2.54, width = 7/2.54)
help("guides")
CostSummaries.Categorised %>%
#subset(Pathogen == 'Campylobacter') %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(Pathogen, CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
group_by(Pathogen)
CostSummaries.Categorised %>%
#subset(Pathogen == 'Campylobacter') %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(Pathogen, CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
group_by(Pathogen) %>% subset(Pathogen == 'Norovirus')
#plots for each pathogen
CostSummaries.Categorised %>%
#subset(Pathogen == 'Campylobacter') %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(Pathogen, CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
group_by(Pathogen) %>%
group_walk(~{
p <- ggplot(.x, aes(x = 1, y = `Annual cost (millions AUD)`,
fill = CostItem,
alpha = SequelOrInitial
)) +
geom_bar(stat = 'identity',
position = 'stack',
color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
guides(fill = guide_legend(override.aes = list(pattern = "none"),
title = 'Cost category'),
alpha = if(length(unique(.x$SequelOrInitial)) == 1){'none'}else{guide_legend(title = 'Sequel vs initial')}
) +
coord_flip() +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
text = element_text(size =  14))
ggsave(filename = paste0('Paper and Presentations/',.y,'ByCatSequel.png'),
p,height = 2.7, width = 10)
})
setwd('~/Google Drive/Angus/Work/Active/Source Attribution/Campylobacter/Campy SA Paper')
# Source data and functions ----------------------------------------------------
source("~/Google Drive/Angus/Work/Active/Source Attribution/Campylobacter/Load from Nullarbor - Merge with Sampling.R")
# Source data and functions ----------------------------------------------------
source("~/Google Drive/Angus/Work/Active/Source Attribution/Campylobacter/Load from Nullarbor - Merge with Sampling.R")
AusCampy <-  AusCampy %>% subset(Source != "Dog")
AusCampy %>% with(table(age))
130 * 30
# Make figures for the report
source("./RFiles/Distributions.R")
source("./RFiles/ClassDefinitions.R")
source("./RFiles/Diseases.R")
library(tidyverse)
library(tidyverse)
library(plotly)
library(ggtext)
# Make figures for the report
source("./RFiles/Distributions.R")
source("./RFiles/ClassDefinitions.R")
source("./RFiles/Diseases.R")
SequelaeNames <- names(SequelaeAssumptions)
CostSummaries.Detailed <- read.csv('./Outputs/CostTable.csv') %>%
#subset(CostItem %in% c('GPSpecialist','ED','Deaths','WTPOngoing','HumanCapital','Medications','Tests'))
mutate(CostItem = recode(CostItem,
GPSpecialist = 'GP and specialist vists',
ED = 'Emergency department visits',
Deaths = "Premature mortality",
WTP = "Pain and suffering",
HumanCapital = 'Non-fatal productivity losses'))
CostPerCase <- read.csv('./Outputs/CostPerCase.csv')
CostSummaries.Categorised <- read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>%
subset(Disease != 'All Diseases') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses'))
PathogenByCost <- CostSummaries.Detailed %>%
subset(!(Pathogen %in% c("All pathogens", "All gastro pathogens")) &
Disease == 'Initial and sequel disease' &
AgeGroup == 'All ages' &
CostItem == "TotalHumanCapital") %>%
with(Pathogen[order(median)])
CostTotals <- CostSummaries.Categorised %>%
mutate(Pathogen = Pathogen %>% factor(levels = PathogenByCost),
SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial, Pathogen) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6)
P.TotalCost.AllPathogens <-  CostSummaries.Categorised %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
mutate(Pathogen = 'All pathogens') %>%
ggplot(aes(x = Pathogen, y = `Annual cost (millions AUD)`,
fill = CostItem,
alpha = SequelOrInitial
)) +
geom_bar(stat = 'identity',
position = 'stack',
color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
guides(fill = guide_legend(override.aes = list(pattern = "none"),
title = 'Cost category'),
alpha = guide_legend(title = 'Sequel vs initial')) +
coord_flip() +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
text = element_text(size =  14))
P.TotalCost.AllPathogens
read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'All Diseases') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses'))
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial))
read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'All Diseases') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial))
read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'All Diseases') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6)
P.TotalCost.AllPathogens <-  read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'All Diseases') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>% View
CostSummaries.Categorised <- read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(!(Pathogen %in% c('All gastro pathogens', 'All pathogens'))) %>% View
P.TotalCost.AllPathogens <-  read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'Initial and sequel disease') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>% View
read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'Initial and sequel disease') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
mutate(Pathogen = 'All pathogens')
P.TotalCost.AllPathogens <-  read.csv('./Outputs/CostTableCategories.csv') %>%
subset(!(CostItem %in% c('FrictionLow', 'FrictionHigh','TotalFrictionHigh','TotalFrictionLow','TotalHumanCapital'))) %>%
subset(Pathogen == 'All pathogens') %>%
subset(Disease != 'Initial and sequel disease') %>%
mutate(SequelOrInitial = if_else(Disease %in% SequelaeNames, 'Sequel disease(s)', 'Initial disease')) %>%
subset(AgeGroup == 'All ages') %>%
mutate(CostItem = recode(CostItem,
Deaths = "Premature Mortality",
HumanCapital = 'Non-fatal productivity losses')) %>%
mutate(SequelOrInitial = forcats::fct_rev(SequelOrInitial)) %>%
group_by(CostItem, SequelOrInitial) %>%
summarise(`Annual cost (millions AUD)` = sum(median)/10^6) %>%
mutate(Pathogen = 'All pathogens') %>%
ggplot(aes(x = Pathogen, y = `Annual cost (millions AUD)`,
fill = CostItem,
alpha = SequelOrInitial
)) +
geom_bar(stat = 'identity',
position = 'stack',
color = 'black') +
scale_alpha_manual(values = c(`Initial disease` = 1, `Sequel disease(s)` = 0.5)) +
guides(fill = guide_legend(override.aes = list(pattern = "none"),
title = 'Cost category'),
alpha = guide_legend(title = 'Sequel vs initial')) +
coord_flip() +
theme(axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
text = element_text(size =  14))
P.TotalCost.AllPathogens
ggsave(P.TotalCost.AllPathogens,filename = 'Paper and Presentations/AllPathByCatSequel.png',
height = 2.7, width = 10)
