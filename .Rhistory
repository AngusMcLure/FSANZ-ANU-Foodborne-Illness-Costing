TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
TyphimuriumOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
TyphimuriumOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
TyphimuriumOutbreak$ed <- rdist('discrete', value = 58/203, continuous = FALSE) #get exactly 58 ed visits
TyphimuriumOutbreak$gp <- ridst('discrete', value = 74/203, continuous = FALSE) #get exactly 74 gp visits
TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
TyphimuriumOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
TyphimuriumOutbreak.Est <- costOutbreak(TyphimuriumOutbreak, ndraws = ndraws,
notifications = TyphimuriumOutbreak.notifications,
separations = list(Salmonellosis = TyphimuriumOutbreak.separations),
deaths = list(Salmonellosis = TyphimuriumOutbreak.deaths))
writeOutbreakTable(TyphimuriumOutbreak,TyphimuriumOutbreak.Est,'Typhimurium')
TyphimuriumOutbreak$gp
TyphimuriumOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
TyphimuriumOutbreak$ed <- rdist('discrete', value = 58/203, continuous = FALSE) #get exactly 58 ed visits
TyphimuriumOutbreak$gp <- rdist('discrete', value = 74/203, continuous = FALSE) #get exactly 74 gp visits
TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
EnteritidisOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
EnteritidisOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
EnteritidisOutbreak.notifications <- list(`<5` = 0, `5-64` = 235, `65+` = 0)
EnteritidisOutbreak.deaths <- list(`<5` = 0, `5-64` = 1, `65+` = 0)
EnteritidisOutbreak.Est <- costOutbreak(EnteritidisOutbreak,ndraws = ndraws,
notifications = EnteritidisOutbreak.notifications,
deaths = list(Salmonellosis = EnteritidisOutbreak.deaths))
writeOutbreakTable(EnteritidisOutbreak,EnteritidisOutbreak.Est,'Enteritidis')
##################################################
#######Salmonella Weltevreden in eggs (2019)######
##################################################
WeltevredenOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
WeltevredenOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
WeltevredenOutbreak.notifications <- list(`<5` = 0, `5-64` = 83, `65+` = 0)
WeltevredenOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
WeltevredenOutbreak.Est <- costOutbreak(WeltevredenOutbreak, ndraws = ndraws,
notifications = WeltevredenOutbreak.notifications,
deaths = list(Salmonellosis = WeltevredenOutbreak.deaths))
writeOutbreakTable(WeltevredenOutbreak,WeltevredenOutbreak.Est,'Weltevreden')
TyphimuriumOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
TyphimuriumOutbreak$ed <- rdist('discrete', value = 58/203, continuous = FALSE) #get exactly 58 ed visits
TyphimuriumOutbreak$gp <- rdist('discrete', value = 74/203, continuous = FALSE) #get exactly 74 gp visits
TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
TyphimuriumOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
TyphimuriumOutbreak.Est <- costOutbreak(TyphimuriumOutbreak, ndraws = ndraws,
notifications = TyphimuriumOutbreak.notifications,
separations = list(Salmonellosis = TyphimuriumOutbreak.separations),
deaths = list(Salmonellosis = TyphimuriumOutbreak.deaths))
TyphimuriumOutbreak$gp
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
print(Outbreak$gp)
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
writeOutbreakTable(TyphimuriumOutbreak,TyphimuriumOutbreak.Est,'Typhimurium')
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
print(Outbreak$gp)
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
print(GPSpecialist)
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
writeOutbreakTable(TyphimuriumOutbreak,TyphimuriumOutbreak.Est,'Typhimurium')
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
EnteritidisOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
EnteritidisOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
EnteritidisOutbreak.notifications <- list(`<5` = 0, `5-64` = 235, `65+` = 0)
EnteritidisOutbreak.deaths <- list(`<5` = 0, `5-64` = 1, `65+` = 0)
EnteritidisOutbreak.Est <- costOutbreak(EnteritidisOutbreak,ndraws = ndraws,
notifications = EnteritidisOutbreak.notifications,
deaths = list(Salmonellosis = EnteritidisOutbreak.deaths))
writeOutbreakTable(EnteritidisOutbreak,EnteritidisOutbreak.Est,'Enteritidis')
##################################################
#######Salmonella Weltevreden in eggs (2019)######
##################################################
WeltevredenOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
WeltevredenOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
WeltevredenOutbreak.notifications <- list(`<5` = 0, `5-64` = 83, `65+` = 0)
WeltevredenOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
WeltevredenOutbreak.Est <- costOutbreak(WeltevredenOutbreak, ndraws = ndraws,
notifications = WeltevredenOutbreak.notifications,
deaths = list(Salmonellosis = WeltevredenOutbreak.deaths))
writeOutbreakTable(WeltevredenOutbreak,WeltevredenOutbreak.Est,'Weltevreden')
TyphimuriumOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
TyphimuriumOutbreak$ed <- rdist('discrete', value = 58/203, continuous = FALSE) #get exactly 58 ed visits
TyphimuriumOutbreak$gp <- rdist('discrete', value = 74/203, continuous = FALSE) #get exactly 74 gp visits
TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE) # get exactly 203 cases (but only 91 tests)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
TyphimuriumOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
TyphimuriumOutbreak.Est <- costOutbreak(TyphimuriumOutbreak, ndraws = ndraws,
notifications = TyphimuriumOutbreak.notifications,
separations = list(Salmonellosis = TyphimuriumOutbreak.separations),
deaths = list(Salmonellosis = TyphimuriumOutbreak.deaths))
writeOutbreakTable(TyphimuriumOutbreak,TyphimuriumOutbreak.Est,'Typhimurium')
EnteritidisOutbreak.Est$cases %>% summariseEpiList()
list(Outbreak = EnteritidisOutbreak.Est$cases) %>% summariseEpiList()
list(Outbreak = WeltevredenOutbreak.Est$cases) %>% summariseEpiList()
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
EnteritidisOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
EnteritidisOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
EnteritidisOutbreak.notifications <- list(`<5` = 0, `5-64` = 235, `65+` = 0)
EnteritidisOutbreak.deaths <- list(`<5` = 0, `5-64` = 1, `65+` = 0)
EnteritidisOutbreak.Est <- costOutbreak(EnteritidisOutbreak,ndraws = ndraws,
notifications = EnteritidisOutbreak.notifications,
deaths = list(Salmonellosis = EnteritidisOutbreak.deaths))
writeOutbreakTable(EnteritidisOutbreak,EnteritidisOutbreak.Est,'Enteritidis')
##################################################
#######Salmonella Weltevreden in eggs (2019)######
##################################################
WeltevredenOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
WeltevredenOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
WeltevredenOutbreak.notifications <- list(`<5` = 0, `5-64` = 83, `65+` = 0)
WeltevredenOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
WeltevredenOutbreak.Est <- costOutbreak(WeltevredenOutbreak, ndraws = ndraws,
notifications = WeltevredenOutbreak.notifications,
deaths = list(Salmonellosis = WeltevredenOutbreak.deaths))
writeOutbreakTable(WeltevredenOutbreak,WeltevredenOutbreak.Est,'Weltevreden')
load('AusFBDiseaseImage.RData')
library(tidyverse)
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
EnteritidisOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
EnteritidisOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
EnteritidisOutbreak.notifications <- list(`<5` = 0, `5-64` = 235, `65+` = 0)
EnteritidisOutbreak.deaths <- list(`<5` = 0, `5-64` = 1, `65+` = 0)
EnteritidisOutbreak.Est <- costOutbreak(EnteritidisOutbreak,ndraws = ndraws,
notifications = EnteritidisOutbreak.notifications,
deaths = list(Salmonellosis = EnteritidisOutbreak.deaths))
writeOutbreakTable(EnteritidisOutbreak,EnteritidisOutbreak.Est,'Enteritidis')
##################################################
#######Salmonella Weltevreden in eggs (2019)######
##################################################
WeltevredenOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
WeltevredenOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
WeltevredenOutbreak.notifications <- list(`<5` = 0, `5-64` = 83, `65+` = 0)
WeltevredenOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
library(tidyverse)
library(mc2d) #for the standrd PERT distribution parameterised by min, mode, max
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
medianCIformat <- function(df,unit = 1000,newline = TRUE,round = FALSE,digits.round = NULL,dropnullinterval = TRUE){
df %>%
mutate(across(c(X5.,X95.,median),~format(ifelse(.x/unit<100 & round, round(.x/unit,digits = digits.round),signif(.x/unit,3)), #format to three significant figures (potentially rounding to closest integer)
big.mark = ",",
scientific = FALSE,
nsmall = 0,
trim = T,
drop0trailing = TRUE))) %>%
mutate(across(c(X5.,X95.),           #remove intervals when they are the same as the point estimate
~if_else(.x == median & dropnullinterval,
'',
.x))) %>%
mutate(Cost = if_else(X5. == '',  #merge cost and and interval into a single line
median,
paste0(median, ifelse(newline,'\n',' '), '(',X5.,' - ',X95.,')')))
}
source('./Outbreak.R')
ndraws <- 10^5
set.seed(20220222)
writeOutbreakTable <- function(Outbreak,OutbreakEst,filename){
CostSummary <- summariseCostList(list(Outbreak = OutbreakEst$costs))$Detailed %>%
subset(AgeGroup == 'All Ages' &
!(Disease %in% c('Initial and Sequel Disease', names(SequelaeAssumptions)))) %>% #only interested in initial disease costs for the report
as.data.frame
CostSummary %>%
select(CostItem, median, X5. = `5%`, X95. = `95%`) %>%
medianCIformat(unit = 1,newline = FALSE) %>%
select(CostItem, Cost) %>%
`rownames<-`(.$CostItem) %>%
`[`(c('GPSpecialist','ED','Hospitalisation','Tests','Medications','HumanCapital',
'WTP','Deaths','TotalHumanCapital'),) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakCosts.csv'))
# Write list of GP, Specialist, ED and Hospital Visits
OutbreakCases <- OutbreakEst$cases[[1]] %>% reduce(`+`) #sum across agegroups
OutbreakHosp <- OutbreakEst$separations[[1]] %>% reduce(`+`) #sum across agegroups
GPSpecialist <- estimateGPSpecialist(Outbreak,
cases = OutbreakCases,
separations = OutbreakHosp,
ndraws = ndraws) %>%
`$<-`('GP',.$gpShort + .$gpLong) %>% #sum over types of gp or specialist visits
`$<-`('Specialist',.$specialistInitial + .$specialistRepeat) %>%
`[`(c('GP','Specialist','physio'))
ED <- estimateGeneric(Outbreak['ed'],ndraws = ndraws,
OutbreakEst$cases[[1]] %>%reduce(`+`)) # sum across agegroups
c(GPSpecialist,ED, list(Hospitalisations = OutbreakHosp)) %>%
quantilesNestedList(1, "CostItem") %>%
rename(X5. = '5%',X95. = '95%') %>%
medianCIformat(newline = FALSE, unit = 1) %>%
select(CostItem, Cost) %>%
write_excel_csv(paste0('./Report/',filename,'OutbreakMedicalPresentations.csv'))
}
ListeriaOutbreak <- PathogenAssumptions$`Listeria monocytogenes`
ListeriaOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
ListeriaOutbreak.notifications <- list(`<5` = 0, `5-64` = 22-10, `65+` = 10) #We are assuming 10 cases were 65+ and the remainder 5-64
ListeriaOutbreak.deaths <- list(`<5` = 1, `5-64` = 7, `65+` = 0) #7 deaths (assumed to be 5-64) and one miscarriage (costed as an additional death)
ListeriaOutbreak.Est <- costOutbreak(ListeriaOutbreak, ndraws = ndraws,
notifications = ListeriaOutbreak.notifications,
deaths = list(Listeriosis = ListeriaOutbreak.deaths))
writeOutbreakTable(ListeriaOutbreak,ListeriaOutbreak.Est,'Listeria')
EnteritidisOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
EnteritidisOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
EnteritidisOutbreak.notifications <- list(`<5` = 0, `5-64` = 235, `65+` = 0)
EnteritidisOutbreak.deaths <- list(`<5` = 0, `5-64` = 1, `65+` = 0)
EnteritidisOutbreak.Est <- costOutbreak(EnteritidisOutbreak,ndraws = ndraws,
notifications = EnteritidisOutbreak.notifications,
deaths = list(Salmonellosis = EnteritidisOutbreak.deaths))
writeOutbreakTable(EnteritidisOutbreak,EnteritidisOutbreak.Est,'Enteritidis')
##################################################
#######Salmonella Weltevreden in eggs (2019)######
##################################################
WeltevredenOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
WeltevredenOutbreak$domestic <- rdist("discrete", value = 1,  continuous = FALSE)
WeltevredenOutbreak.notifications <- list(`<5` = 0, `5-64` = 83, `65+` = 0)
WeltevredenOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
WeltevredenOutbreak.Est <- costOutbreak(WeltevredenOutbreak, ndraws = ndraws,
notifications = WeltevredenOutbreak.notifications,
deaths = list(Salmonellosis = WeltevredenOutbreak.deaths))
writeOutbreakTable(WeltevredenOutbreak,WeltevredenOutbreak.Est,'Weltevreden')
TyphimuriumOutbreak <- PathogenAssumptions$`Non-typhoidal salmonella`
TyphimuriumOutbreak$ed <- rdist('discrete', value = 58/203, continuous = FALSE) #get exactly 58 ed visits
TyphimuriumOutbreak$gp <- rdist('discrete', value = 74/203, continuous = FALSE) #get exactly 74 gp visits
TyphimuriumOutbreak$domestic <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$foodborne <- rdist("discrete", value = 1, continuous = FALSE)
TyphimuriumOutbreak$underreporting <- rdist("discrete", value = 203/91, continuous = FALSE) # get exactly 203 cases (but only 91 tests)
TyphimuriumOutbreak.notifications <- list(`<5` = 0, `5-64` = 91, `65+` = 0)
TyphimuriumOutbreak.separations <- list(`<5` = 0, `5-64` = 32, `65+` = 0)
TyphimuriumOutbreak.deaths <- list(`<5` = 0, `5-64` = 0, `65+` = 0)
TyphimuriumOutbreak.Est <- costOutbreak(TyphimuriumOutbreak, ndraws = ndraws,
notifications = TyphimuriumOutbreak.notifications,
separations = list(Salmonellosis = TyphimuriumOutbreak.separations),
deaths = list(Salmonellosis = TyphimuriumOutbreak.deaths))
writeOutbreakTable(TyphimuriumOutbreak,TyphimuriumOutbreak.Est,'Typhimurium')
