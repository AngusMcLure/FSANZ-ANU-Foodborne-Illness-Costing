mode
}
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
LogitFactor <- rgamma(N, rate = 5, shape = 1)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
kernelmode <- function(x){
dns <- density(x)
mode <- mean(dns$x[dns$y == max(dns$y)]) #Take mean on the off chance there is a tie for max density
mode
}
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
LogitFactor <- rgamma(N, rate = 5, shape = 10)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
kernelmode <- function(x){
dns <- density(x)
mode <- mean(dns$x[dns$y == max(dns$y)]) #Take mean on the off chance there is a tie for max density
mode
}
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
help(rgamma)
gammamean <- 0.01; gammavar <- 0.02;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
kernelmode <- function(x){
dns <- density(x)
mode <- mean(dns$x[dns$y == max(dns$y)]) #Take mean on the off chance there is a tie for max density
mode
}
1-kernelmode(Susc1Dose)
N <- 1e7
Susc1Dose <- rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.01; gammavar <- 0.02;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
LogitFactor
LogitFactor %>% mean
LogitFactor %>% variance
LogitFactor %>% var
LogitFactor %>% median
gammamean <- 0.1; gammavar <- 0.2;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.2; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.5; gammavar <- 1;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.5; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.4; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.3; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.25; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.3; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.28; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.25; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
N <- 1e7
Susc1Dose <- rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.25; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.24; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
N <- 1e8
Susc1Dose <- rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.24; gammavar <- 0.4;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
N <- 1e7
Susc1Dose <- rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.24; gammavar <- 0.42;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
N <- 1e7
Susc1Dose <- rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.24; gammavar <- 0.45;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
gammamean <- 0.24; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
Susc2Dose <- plogis(qlogis(Susc1Dose) - LogitFactor)
1-kernelmode(Susc1Dose)
1-kernelmode(Susc2Dose); 1-quantile(Susc2Dose, probs = c(0.975, 0.025))
mean(Susc1Dose)
mean(Susc2Dose)
Susc1Dose %>% hist %>% plot()
Susc1Dose %>% density() %>% plot()
Susc2Dose %>% density() %>% plot()
Susc2Dose[Susc2Dose<0.001] %>% density() %>% plot()
abcd
LogitFactor %>% density() %>% plot()
LogitFactor %>% density() %>% plot(from =0, to = 1.5)
LogitFactor %>% density(from =0, to = 1.5) %>% plot()
LogitFactor %>% density(from =0, to = 0.5) %>% plot()
LogitFactor %>% density(from =0, to = 0.1) %>% plot()
LogitFactor %>% density(from =0, to = 0.05) %>% plot()
Susc2Dose %>% hist() %>% plot()
Susc2Dose %>% hist(breaks = 1000) %>% plot()
LogitFactor %>% density(from =0, to = 0.05) %>% plot()
Susc1Dose %>% hist(breaks = 1000) %>% plot()
Susc2Dose %>% hist(breaks = 1000) %>% plot()
Susc1Dose %>% hist(breaks = 1000) %>% plot(from = 0, to = 0.2)
Susc1Dose %>% hist(breaks = 1000, from = 0, to = 0.2) %>% plot()
Susc1Dose %>% hist(breaks = 1000, from = 0, to = 0.2) %>% plot()
seq(0,0.2,1000)
seq(0,0.2,lenghtout = 1000)
seq(0,0.2,lengthout = 1000)
help(seq)
Susc1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000)) %>% plot()
Susc2Dose %>% hist(breaks = seq(0,0.2,length.out = 1000)) %>% plot()
Susc1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000)) %>% plot()
Susc2Dose %>% hist(breaks = seq(0,0.2,length.out = 1000)) %>% plot()
Susc1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
Susc2Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
Susc1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
Susc2Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
LogitFactor %>% density(from =0, to = 0.05) %>% plot()
mean(Susc1Dose)
mean(Susc2Dose)
Susc1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
Susc2Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
1-quantile(Susc2Dose, probs = c(0.99))
1-quantile(Susc2Dose, probs = c(0.999))
1-quantile(Susc2Dose, probs = c(0.001))
1-quantile(Susc2Dose, probs = c(0.01))
1-quantile(Susc2Dose, probs = c(0.025))
1-quantile(Susc2Dose, probs = c(0.01))
1-quantile(Susc2Dose, probs = c(0.001))
1-quantile(Susc2Dose, probs = c(0.0001))
1-quantile(Susc2Dose, probs = c(0.00001))
quantile(Susc2Dose, probs = c(0.99))
quantile(Susc2Dose, probs = c(0.975))
quantile(Susc2Dose, probs = c(0.99))
quantile(Susc2Dose, probs = c(0.999))
quantile(Susc2Dose, probs = c(0.9999))
quantile(Susc2Dose, probs = c(0.999999))
quantile(Susc2Dose, probs = c(0.001))
quantile(Susc2Dose, probs = c(0.01))
quantile(Susc2Dose, probs = c(0.01)) * 100
quantile(Susc2Dose, probs = c(0.001)) * 100
quantile(Susc2Dose, probs = c(0.0001)) * 100
quantile(Susc2Dose, probs = c(0.00001)) * 100
VE1Dose <- 1-rpert(N,   min = 0.01236237, mode = 0.05, max = 0.1806099)
gammamean <- 0.24; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0,0.2,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
help(weibull)
help(rweibull)
LogitFactor <- rweibull(N, shape = 1,1)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
LogitFactor <- rweibull(N, shape = 1,1)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1,scale = 1)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1,scale = 5)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 5,scale = 1)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
LogitFactor <- rweibull(N, shape = 5,scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 3,scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2,scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1,scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.25)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.2)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.15)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.5, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.1, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.16)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.1)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.01)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.001)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.0001)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.01)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.05)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.04)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.01)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.005)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.007)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.008)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.009)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 0.2, scale = 0.01)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
LogitFactor <- rweibull(N, shape = 3, scale = 0.15)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 3, scale = 0.2)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 3, scale = 0.22)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 3, scale = 0.24)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 3, scale = 0.28)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2.5, scale = 0.28)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.28)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor %>% density(from =0, to = 0.05) %>% plot()
LogitFactor %>% density(from =0, to = 1) %>% plot()
LogitFactor <- rweibull(N, shape = 3, scale = 0.28)
LogitFactor %>% density(from =0, to = 1) %>% plot()
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.28)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
LogitFactor <- rweibull(N, shape = 2, scale = 0.1)
LogitFactor %>% density(from =0, to = 1) %>% plot()
LogitFactor <- rweibull(N, shape = 5, scale = 0.1)
LogitFactor %>% density(from =0, to = 1) %>% plot()
LogitFactor <- rweibull(N, shape = 1, scale = 0.1)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.1)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 2.5, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.3, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.2, scale = 0.2)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.2, scale = 0.15)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.1, scale = 0.15)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.15)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
gammamean <- 0.24; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.15)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
kernelmode(VE1Dose)
kernelmode(VE2Dose); quantile(VE2Dose, probs = c(0.025,0.975))
mean(VE1Dose)
mean(VE2Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
getPertMinMaxFromQuant(0.04, 0.01, 0.28, shape = shape)
getPertMinMaxFromQuant(0.05, 0.02, 0.13, shape = shape)
with(getPertMinMaxFromQuant(0.05, 0.02, 0.13, shape = shape), qpert(c(0.025, 0.5, 0.975), min, 0.05, max, shape = shape))
getPertMinMaxModeFromQuant(0.05, 0.02, 0.13, shape = shape)
getPertMinMaxFromQuant(0.05, 0.02, 0.13, shape = shape)
getPertMinMaxModeFromQuant(0.05, 0.02, 0.13, shape = shape)
parsVE1 <- getPertMinMaxModeFromQuant(0.05, 0.02, 0.13, shape = shape)
parsVE1 <- getPertMinMaxModeFromQuant(0.05, 0.02, 0.13, shape = shape)
#We fit a non-negative multiplier for
kernelmode <- function(x){
dns <- density(x)
mode <- mean(dns$x[dns$y == max(dns$y)]) #Take mean on the off chance there is a tie for max density
mode
}
VE1Dose <- 1-rpert(N,   min = parsVE1$min, mode = parsVE1$mode, max = parsVE1$max)
mean(VE1Dose)
VE1Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.15)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.2)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
LogitFactor <- rweibull(N, shape = 1.5, scale = 0.3)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
mean(VE1Dose)
LogitFactor <- rweibull(N, shape = 1.1, scale = 0.3)
LogitFactor %>% density(from =0, to = 1) %>% plot()
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
mean(VE1Dose)
gammamean <- 0.24; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
gammamean <- 0.3; gammavar <- 0.5;
LogitFactor <- rgamma(N, scale = gammavar/gammamean, shape = gammamean^2/gammavar)
VE2Dose <- plogis(qlogis(VE1Dose) + LogitFactor)
quantile(VE2Dose, probs = c(0.5, 0.025,0.975))
VE2Dose %>% hist(breaks = seq(0.8,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
VE1Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
VE2Dose %>% hist(breaks = seq(0.7,1,length.out = 1000))
